Use GPU: 0 for training
==> loading teacher model
D:\Uni\student-research-project\steve\SimKD\train_student.py:299: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=map_location)["model"])
==> done
6 1.0
Files already downloaded and verified
Files already downloaded and verified
Test: [0/313]	GPU: 0	Time: 10.922	Loss 0.7320	Acc@1 81.250	Acc@5 90.625
Test: [200/313]	GPU: 0	Time: 12.508	Loss 0.8817	Acc@1 79.260	Acc@5 94.527
teacher accuracy:  79.42
==> training...
Epoch: [1][0/782]	GPU 0	Time: 22.596	Loss 15.4450	Acc@1 0.000	Acc@5 4.688
Epoch: [1][200/782]	GPU 0	Time: 28.304	Loss 14.8981	Acc@1 1.104	Acc@5 4.765
Epoch: [1][400/782]	GPU 0	Time: 33.388	Loss 14.3468	Acc@1 0.974	Acc@5 4.750
Epoch: [1][600/782]	GPU 0	Time: 38.463	Loss 14.0516	Acc@1 0.946	Acc@5 4.516
 * Epoch 1, GPU 0, Acc@1 0.906, Acc@5 4.516, Time 64.78
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.174	Loss 3.7615	Acc@1 9.375	Acc@5 37.500
Test: [200/313]	GPU: 0	Time: 10.649	Loss 3.7783	Acc@1 11.287	Acc@5 34.935
 ** Acc@1 11.360, Acc@5 35.120
==> training...
Epoch: [2][0/782]	GPU 0	Time: 21.925	Loss 12.4067	Acc@1 1.562	Acc@5 1.562
Epoch: [2][200/782]	GPU 0	Time: 27.127	Loss 12.8738	Acc@1 0.785	Acc@5 4.213
Epoch: [2][400/782]	GPU 0	Time: 32.209	Loss 12.7628	Acc@1 0.814	Acc@5 4.259
Epoch: [2][600/782]	GPU 0	Time: 37.292	Loss 12.6814	Acc@1 0.788	Acc@5 4.207
 * Epoch 2, GPU 0, Acc@1 0.766, Acc@5 4.150, Time 62.45
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 9.665	Loss 3.2947	Acc@1 21.875	Acc@5 50.000
Test: [200/313]	GPU: 0	Time: 10.203	Loss 3.4712	Acc@1 16.620	Acc@5 44.201
 ** Acc@1 16.830, Acc@5 44.160
==> training...
Traceback (most recent call last):
  File "D:\Uni\student-research-project\steve\SimKD\train_student.py", line 684, in <module>
    main()
  File "D:\Uni\student-research-project\steve\SimKD\train_student.py", line 326, in main
    main_worker(None if ngpus_per_node > 1 else opt.gpu_id, ngpus_per_node, opt)
  File "D:\Uni\student-research-project\steve\SimKD\train_student.py", line 580, in main_worker
    train_acc, train_acc_top5, train_loss = train(
                                            ^^^^^^
  File "D:\Uni\student-research-project\steve\SimKD\helper\loops.py", line 93, in train_distill
    for idx, data in enumerate(train_loader):
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\programming\miniconda3\envs\SRP_steve\Lib\site-packages\torch\utils\data\dataloader.py", line 440, in __iter__
    return self._get_iterator()
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\programming\miniconda3\envs\SRP_steve\Lib\site-packages\torch\utils\data\dataloader.py", line 388, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\programming\miniconda3\envs\SRP_steve\Lib\site-packages\torch\utils\data\dataloader.py", line 1038, in __init__
    w.start()
  File "D:\programming\miniconda3\envs\SRP_steve\Lib\multiprocessing\process.py", line 121, in start
    self._popen = self._Popen(self)
                  ^^^^^^^^^^^^^^^^^
  File "D:\programming\miniconda3\envs\SRP_steve\Lib\multiprocessing\context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\programming\miniconda3\envs\SRP_steve\Lib\multiprocessing\context.py", line 336, in _Popen
    return Popen(process_obj)
           ^^^^^^^^^^^^^^^^^^
  File "D:\programming\miniconda3\envs\SRP_steve\Lib\multiprocessing\popen_spawn_win32.py", line 95, in __init__
    reduction.dump(process_obj, to_child)
  File "D:\programming\miniconda3\envs\SRP_steve\Lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
  File "D:\programming\miniconda3\envs\SRP_steve\Lib\site-packages\numpy\core\__init__.py", line 145, in _DType_reduce
    def _DType_reduce(DType):

KeyboardInterrupt
