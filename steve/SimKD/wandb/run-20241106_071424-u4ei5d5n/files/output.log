Use GPU: 0 for training
==> loading teacher model
D:\Uni\student-research-project\steve\SimKD\train_student.py:300: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=map_location)["model"])
==> done
6 1.0
Files already downloaded and verified
Files already downloaded and verified
Test: [0/313]	GPU: 0	Time: 9.850	Loss 0.7333	Acc@1 81.250	Acc@5 90.625
Test: [200/313]	GPU: 0	Time: 10.469	Loss 0.8817	Acc@1 79.260	Acc@5 94.527
teacher accuracy:  79.42
==> training...
Epoch: [1][0/782]	GPU 0	Time: 24.383	Loss 0.7829	Acc@1 3.125	Acc@5 9.375
Epoch: [1][200/782]	GPU 0	Time: 27.409	Loss 0.5997	Acc@1 1.244	Acc@5 5.939
Epoch: [1][400/782]	GPU 0	Time: 30.409	Loss 0.5544	Acc@1 1.317	Acc@5 6.289
Epoch: [1][600/782]	GPU 0	Time: 33.659	Loss 0.5383	Acc@1 1.386	Acc@5 6.552
 * Epoch 1, GPU 0, Acc@1 1.398, Acc@5 6.692, Time 51.88
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 11.021	Loss 4.5891	Acc@1 0.000	Acc@5 9.375
Test: [200/313]	GPU: 0	Time: 12.871	Loss 4.5572	Acc@1 1.648	Acc@5 7.152
 ** Acc@1 1.640, Acc@5 7.560
==> training...
Epoch: [2][0/782]	GPU 0	Time: 23.949	Loss 0.5000	Acc@1 0.000	Acc@5 10.938
Epoch: [2][200/782]	GPU 0	Time: 31.607	Loss 0.4991	Acc@1 1.741	Acc@5 7.805
Epoch: [2][400/782]	GPU 0	Time: 37.024	Loss 0.4986	Acc@1 1.687	Acc@5 7.996
Epoch: [2][600/782]	GPU 0	Time: 41.145	Loss 0.4975	Acc@1 1.812	Acc@5 8.179
 * Epoch 2, GPU 0, Acc@1 1.834, Acc@5 8.170, Time 62.59
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.701	Loss 4.5049	Acc@1 0.000	Acc@5 12.500
Test: [200/313]	GPU: 0	Time: 12.238	Loss 4.4905	Acc@1 1.990	Acc@5 9.204
 ** Acc@1 1.940, Acc@5 9.330
==> training...
Epoch: [3][0/782]	GPU 0	Time: 25.381	Loss 0.5255	Acc@1 1.562	Acc@5 6.250
Epoch: [3][200/782]	GPU 0	Time: 32.021	Loss 0.4953	Acc@1 1.959	Acc@5 8.800
Epoch: [3][400/782]	GPU 0	Time: 37.955	Loss 0.4931	Acc@1 2.003	Acc@5 9.278
Epoch: [3][600/782]	GPU 0	Time: 43.543	Loss 0.4930	Acc@1 2.121	Acc@5 9.853
 * Epoch 3, GPU 0, Acc@1 2.326, Acc@5 10.678, Time 70.80
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 11.962	Loss 4.4366	Acc@1 6.250	Acc@5 6.250
Test: [200/313]	GPU: 0	Time: 13.010	Loss 4.3933	Acc@1 3.436	Acc@5 14.210
 ** Acc@1 3.440, Acc@5 14.550
==> training...
Epoch: [4][0/782]	GPU 0	Time: 25.605	Loss 0.4692	Acc@1 1.562	Acc@5 17.188
Epoch: [4][200/782]	GPU 0	Time: 40.532	Loss 0.4875	Acc@1 3.475	Acc@5 14.824
Epoch: [4][400/782]	GPU 0	Time: 51.734	Loss 0.4880	Acc@1 3.491	Acc@5 15.083
Epoch: [4][600/782]	GPU 0	Time: 61.832	Loss 0.4882	Acc@1 3.645	Acc@5 15.487
 * Epoch 4, GPU 0, Acc@1 3.794, Acc@5 15.876, Time 96.00
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.748	Loss 4.3062	Acc@1 9.375	Acc@5 15.625
Test: [200/313]	GPU: 0	Time: 14.407	Loss 4.2993	Acc@1 4.415	Acc@5 18.284
 ** Acc@1 4.380, Acc@5 18.340
==> training...
Epoch: [5][0/782]	GPU 0	Time: 23.882	Loss 0.5053	Acc@1 3.125	Acc@5 15.625
Epoch: [5][200/782]	GPU 0	Time: 30.122	Loss 0.4849	Acc@1 4.610	Acc@5 18.462
Epoch: [5][400/782]	GPU 0	Time: 36.405	Loss 0.4847	Acc@1 4.578	Acc@5 18.333
Epoch: [5][600/782]	GPU 0	Time: 41.724	Loss 0.4837	Acc@1 4.628	Acc@5 18.534
 * Epoch 5, GPU 0, Acc@1 4.730, Acc@5 18.884, Time 72.15
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.554	Loss 4.1817	Acc@1 9.375	Acc@5 25.000
Test: [200/313]	GPU: 0	Time: 12.025	Loss 4.2035	Acc@1 5.224	Acc@5 20.958
 ** Acc@1 5.350, Acc@5 21.170
==> training...
Epoch: [6][0/782]	GPU 0	Time: 24.476	Loss 0.4798	Acc@1 7.812	Acc@5 12.500
Epoch: [6][200/782]	GPU 0	Time: 27.185	Loss 0.4833	Acc@1 5.006	Acc@5 20.002
Epoch: [6][400/782]	GPU 0	Time: 32.407	Loss 0.4813	Acc@1 5.194	Acc@5 20.437
Epoch: [6][600/782]	GPU 0	Time: 38.448	Loss 0.4811	Acc@1 5.358	Acc@5 20.908
 * Epoch 6, GPU 0, Acc@1 5.458, Acc@5 21.254, Time 69.83
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.128	Loss 4.0821	Acc@1 12.500	Acc@5 21.875
Test: [200/313]	GPU: 0	Time: 12.423	Loss 4.1369	Acc@1 6.266	Acc@5 23.181
 ** Acc@1 6.330, Acc@5 23.180
==> training...
Epoch: [7][0/782]	GPU 0	Time: 24.713	Loss 0.4603	Acc@1 6.250	Acc@5 23.438
Epoch: [7][200/782]	GPU 0	Time: 27.461	Loss 0.4775	Acc@1 5.947	Acc@5 22.030
Epoch: [7][400/782]	GPU 0	Time: 30.646	Loss 0.4779	Acc@1 6.008	Acc@5 22.935
Epoch: [7][600/782]	GPU 0	Time: 34.149	Loss 0.4777	Acc@1 6.143	Acc@5 23.401
 * Epoch 7, GPU 0, Acc@1 6.322, Acc@5 23.690, Time 57.11
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.142	Loss 4.0341	Acc@1 9.375	Acc@5 25.000
Test: [200/313]	GPU: 0	Time: 12.540	Loss 4.0606	Acc@1 7.354	Acc@5 26.353
 ** Acc@1 7.310, Acc@5 26.270
==> training...
Epoch: [8][0/782]	GPU 0	Time: 27.044	Loss 0.5029	Acc@1 1.562	Acc@5 26.562
Epoch: [8][200/782]	GPU 0	Time: 31.025	Loss 0.4775	Acc@1 7.323	Acc@5 25.428
Epoch: [8][400/782]	GPU 0	Time: 34.208	Loss 0.4757	Acc@1 7.474	Acc@5 25.990
Epoch: [8][600/782]	GPU 0	Time: 37.457	Loss 0.4752	Acc@1 7.508	Acc@5 26.134
 * Epoch 8, GPU 0, Acc@1 7.556, Acc@5 26.256, Time 52.71
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.665	Loss 3.9912	Acc@1 9.375	Acc@5 25.000
Test: [200/313]	GPU: 0	Time: 12.565	Loss 3.9869	Acc@1 8.815	Acc@5 28.078
 ** Acc@1 8.600, Acc@5 28.360
==> training...
Epoch: [9][0/782]	GPU 0	Time: 23.754	Loss 0.4780	Acc@1 3.125	Acc@5 31.250
Epoch: [9][200/782]	GPU 0	Time: 30.984	Loss 0.4736	Acc@1 8.022	Acc@5 27.596
Epoch: [9][400/782]	GPU 0	Time: 37.794	Loss 0.4718	Acc@1 8.206	Acc@5 28.425
Epoch: [9][600/782]	GPU 0	Time: 42.608	Loss 0.4719	Acc@1 8.382	Acc@5 28.479
 * Epoch 9, GPU 0, Acc@1 8.418, Acc@5 28.674, Time 62.18
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.899	Loss 3.8983	Acc@1 9.375	Acc@5 28.125
Test: [200/313]	GPU: 0	Time: 12.368	Loss 3.9180	Acc@1 9.857	Acc@5 31.001
 ** Acc@1 9.870, Acc@5 31.250
==> training...
Epoch: [10][0/782]	GPU 0	Time: 24.438	Loss 0.4415	Acc@1 10.938	Acc@5 31.250
Epoch: [10][200/782]	GPU 0	Time: 31.663	Loss 0.4693	Acc@1 9.507	Acc@5 30.457
Epoch: [10][400/782]	GPU 0	Time: 38.771	Loss 0.4685	Acc@1 9.418	Acc@5 30.595
Epoch: [10][600/782]	GPU 0	Time: 46.063	Loss 0.4684	Acc@1 9.372	Acc@5 30.631
 * Epoch 10, GPU 0, Acc@1 9.382, Acc@5 30.778, Time 78.14
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.652	Loss 3.8689	Acc@1 12.500	Acc@5 31.250
Test: [200/313]	GPU: 0	Time: 11.555	Loss 3.8746	Acc@1 10.836	Acc@5 32.929
 ** Acc@1 10.630, Acc@5 32.850
==> training...
Epoch: [11][0/782]	GPU 0	Time: 24.004	Loss 0.4784	Acc@1 12.500	Acc@5 35.938
Epoch: [11][200/782]	GPU 0	Time: 30.731	Loss 0.4661	Acc@1 10.432	Acc@5 32.160
Epoch: [11][400/782]	GPU 0	Time: 37.721	Loss 0.4652	Acc@1 10.532	Acc@5 32.520
Epoch: [11][600/782]	GPU 0	Time: 45.018	Loss 0.4660	Acc@1 10.462	Acc@5 32.563
 * Epoch 11, GPU 0, Acc@1 10.622, Acc@5 32.728, Time 74.43
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.722	Loss 3.8454	Acc@1 9.375	Acc@5 28.125
Test: [200/313]	GPU: 0	Time: 12.121	Loss 3.8090	Acc@1 12.267	Acc@5 34.328
 ** Acc@1 12.000, Acc@5 34.510
==> training...
Epoch: [12][0/782]	GPU 0	Time: 24.487	Loss 0.4892	Acc@1 10.938	Acc@5 34.375
Epoch: [12][200/782]	GPU 0	Time: 29.686	Loss 0.4623	Acc@1 10.658	Acc@5 33.504
Epoch: [12][400/782]	GPU 0	Time: 36.634	Loss 0.4630	Acc@1 11.284	Acc@5 34.231
Epoch: [12][600/782]	GPU 0	Time: 43.075	Loss 0.4629	Acc@1 11.481	Acc@5 34.414
 * Epoch 12, GPU 0, Acc@1 11.726, Acc@5 34.718, Time 75.32
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.732	Loss 3.6462	Acc@1 15.625	Acc@5 34.375
Test: [200/313]	GPU: 0	Time: 12.168	Loss 3.7217	Acc@1 13.915	Acc@5 37.220
 ** Acc@1 13.700, Acc@5 37.290
==> training...
Epoch: [13][0/782]	GPU 0	Time: 24.429	Loss 0.4814	Acc@1 7.812	Acc@5 32.812
Epoch: [13][200/782]	GPU 0	Time: 29.276	Loss 0.4597	Acc@1 12.609	Acc@5 35.619
Epoch: [13][400/782]	GPU 0	Time: 34.519	Loss 0.4600	Acc@1 12.625	Acc@5 36.140
Epoch: [13][600/782]	GPU 0	Time: 40.284	Loss 0.4592	Acc@1 12.604	Acc@5 36.299
 * Epoch 13, GPU 0, Acc@1 12.756, Acc@5 36.642, Time 72.07
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.691	Loss 3.5845	Acc@1 12.500	Acc@5 34.375
Test: [200/313]	GPU: 0	Time: 12.610	Loss 3.6612	Acc@1 14.972	Acc@5 39.024
 ** Acc@1 14.800, Acc@5 39.110
==> training...
Epoch: [14][0/782]	GPU 0	Time: 24.304	Loss 0.4406	Acc@1 15.625	Acc@5 48.438
Epoch: [14][200/782]	GPU 0	Time: 27.345	Loss 0.4562	Acc@1 13.518	Acc@5 37.578
Epoch: [14][400/782]	GPU 0	Time: 32.238	Loss 0.4558	Acc@1 13.587	Acc@5 38.174
Epoch: [14][600/782]	GPU 0	Time: 37.979	Loss 0.4553	Acc@1 13.753	Acc@5 38.428
 * Epoch 14, GPU 0, Acc@1 13.818, Acc@5 38.628, Time 71.73
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.628	Loss 3.5842	Acc@1 15.625	Acc@5 43.750
Test: [200/313]	GPU: 0	Time: 12.492	Loss 3.6091	Acc@1 15.438	Acc@5 41.791
 ** Acc@1 15.520, Acc@5 41.290
==> training...
Epoch: [15][0/782]	GPU 0	Time: 24.294	Loss 0.4600	Acc@1 29.688	Acc@5 51.562
Epoch: [15][200/782]	GPU 0	Time: 27.981	Loss 0.4508	Acc@1 15.026	Acc@5 40.058
Epoch: [15][400/782]	GPU 0	Time: 31.266	Loss 0.4509	Acc@1 14.912	Acc@5 40.263
Epoch: [15][600/782]	GPU 0	Time: 35.427	Loss 0.4516	Acc@1 14.988	Acc@5 40.414
 * Epoch 15, GPU 0, Acc@1 15.090, Acc@5 40.734, Time 65.05
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.441	Loss 3.5071	Acc@1 15.625	Acc@5 37.500
Test: [200/313]	GPU: 0	Time: 13.037	Loss 3.5306	Acc@1 17.133	Acc@5 43.066
 ** Acc@1 17.020, Acc@5 43.060
==> training...
