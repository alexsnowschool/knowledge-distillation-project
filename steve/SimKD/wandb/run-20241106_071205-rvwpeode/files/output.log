Use GPU: 0 for training
==> loading teacher model
D:\Uni\student-research-project\steve\SimKD\train_student.py:300: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path, map_location=map_location)["model"])
==> done
6 1.0
Files already downloaded and verified
Files already downloaded and verified
Test: [0/313]	GPU: 0	Time: 10.073	Loss 0.7321	Acc@1 81.250	Acc@5 90.625
Test: [200/313]	GPU: 0	Time: 10.551	Loss 0.8817	Acc@1 79.260	Acc@5 94.527
teacher accuracy:  79.41
==> training...
Epoch: [1][0/782]	GPU 0	Time: 21.289	Loss 0.7934	Acc@1 0.000	Acc@5 3.125
Epoch: [1][200/782]	GPU 0	Time: 24.743	Loss 0.5983	Acc@1 1.220	Acc@5 5.667
Epoch: [1][400/782]	GPU 0	Time: 27.673	Loss 0.5557	Acc@1 1.259	Acc@5 5.790
Epoch: [1][600/782]	GPU 0	Time: 30.595	Loss 0.5393	Acc@1 1.243	Acc@5 5.842
 * Epoch 1, GPU 0, Acc@1 1.252, Acc@5 5.828, Time 45.62
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 9.328	Loss 4.6532	Acc@1 0.000	Acc@5 12.500
Test: [200/313]	GPU: 0	Time: 10.411	Loss 4.6234	Acc@1 1.042	Acc@5 5.053
 ** Acc@1 1.000, Acc@5 5.200
==> training...
Epoch: [2][0/782]	GPU 0	Time: 21.290	Loss 0.4910	Acc@1 0.000	Acc@5 4.688
Epoch: [2][200/782]	GPU 0	Time: 23.996	Loss 0.5009	Acc@1 1.143	Acc@5 5.512
Epoch: [2][400/782]	GPU 0	Time: 26.772	Loss 0.5011	Acc@1 1.208	Acc@5 5.888
Epoch: [2][600/782]	GPU 0	Time: 29.497	Loss 0.4998	Acc@1 1.404	Acc@5 6.510
 * Epoch 2, GPU 0, Acc@1 1.574, Acc@5 7.146, Time 43.21
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 9.288	Loss 4.5140	Acc@1 3.125	Acc@5 9.375
Test: [200/313]	GPU: 0	Time: 10.240	Loss 4.5447	Acc@1 2.456	Acc@5 9.204
 ** Acc@1 2.460, Acc@5 9.820
==> training...
Epoch: [3][0/782]	GPU 0	Time: 21.441	Loss 0.5092	Acc@1 0.000	Acc@5 9.375
Epoch: [3][200/782]	GPU 0	Time: 24.653	Loss 0.4943	Acc@1 2.464	Acc@5 10.137
Epoch: [3][400/782]	GPU 0	Time: 27.457	Loss 0.4934	Acc@1 2.618	Acc@5 10.875
Epoch: [3][600/782]	GPU 0	Time: 30.215	Loss 0.4935	Acc@1 2.795	Acc@5 11.585
 * Epoch 3, GPU 0, Acc@1 2.914, Acc@5 12.016, Time 45.01
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.531	Loss 4.3104	Acc@1 6.250	Acc@5 18.750
Test: [200/313]	GPU: 0	Time: 12.040	Loss 4.4268	Acc@1 3.063	Acc@5 13.246
 ** Acc@1 3.200, Acc@5 13.790
==> training...
Epoch: [4][0/782]	GPU 0	Time: 24.642	Loss 0.4845	Acc@1 3.125	Acc@5 10.938
Epoch: [4][200/782]	GPU 0	Time: 30.502	Loss 0.4914	Acc@1 3.420	Acc@5 14.117
Epoch: [4][400/782]	GPU 0	Time: 36.568	Loss 0.4902	Acc@1 3.558	Acc@5 14.760
Epoch: [4][600/782]	GPU 0	Time: 41.688	Loss 0.4893	Acc@1 3.731	Acc@5 15.092
 * Epoch 4, GPU 0, Acc@1 3.768, Acc@5 15.426, Time 71.16
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.815	Loss 4.2310	Acc@1 12.500	Acc@5 18.750
Test: [200/313]	GPU: 0	Time: 12.235	Loss 4.3316	Acc@1 4.260	Acc@5 17.397
 ** Acc@1 4.390, Acc@5 17.750
==> training...
Epoch: [5][0/782]	GPU 0	Time: 26.011	Loss 0.4952	Acc@1 3.125	Acc@5 17.188
Epoch: [5][200/782]	GPU 0	Time: 30.081	Loss 0.4859	Acc@1 4.408	Acc@5 17.600
Epoch: [5][400/782]	GPU 0	Time: 33.704	Loss 0.4849	Acc@1 4.543	Acc@5 17.737
Epoch: [5][600/782]	GPU 0	Time: 38.390	Loss 0.4856	Acc@1 4.628	Acc@5 18.053
 * Epoch 5, GPU 0, Acc@1 4.664, Acc@5 18.246, Time 66.45
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.623	Loss 4.1873	Acc@1 9.375	Acc@5 25.000
Test: [200/313]	GPU: 0	Time: 12.848	Loss 4.2461	Acc@1 5.271	Acc@5 19.761
 ** Acc@1 5.400, Acc@5 20.370
==> training...
Epoch: [6][0/782]	GPU 0	Time: 26.578	Loss 0.4545	Acc@1 3.125	Acc@5 17.188
Epoch: [6][200/782]	GPU 0	Time: 29.601	Loss 0.4835	Acc@1 5.201	Acc@5 19.652
Epoch: [6][400/782]	GPU 0	Time: 32.662	Loss 0.4818	Acc@1 5.311	Acc@5 19.915
Epoch: [6][600/782]	GPU 0	Time: 36.570	Loss 0.4815	Acc@1 5.350	Acc@5 20.162
 * Epoch 6, GPU 0, Acc@1 5.416, Acc@5 20.448, Time 70.19
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 14.084	Loss 4.1077	Acc@1 9.375	Acc@5 21.875
Test: [200/313]	GPU: 0	Time: 24.521	Loss 4.1803	Acc@1 5.861	Acc@5 21.688
 ** Acc@1 6.010, Acc@5 22.010
==> training...
Epoch: [7][0/782]	GPU 0	Time: 24.020	Loss 0.4816	Acc@1 6.250	Acc@5 26.562
Epoch: [7][200/782]	GPU 0	Time: 27.745	Loss 0.4802	Acc@1 5.768	Acc@5 21.043
Epoch: [7][400/782]	GPU 0	Time: 32.307	Loss 0.4783	Acc@1 5.946	Acc@5 21.630
Epoch: [7][600/782]	GPU 0	Time: 36.505	Loss 0.4785	Acc@1 5.915	Acc@5 21.859
 * Epoch 7, GPU 0, Acc@1 6.046, Acc@5 21.986, Time 54.52
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.483	Loss 4.0293	Acc@1 9.375	Acc@5 28.125
Test: [200/313]	GPU: 0	Time: 12.284	Loss 4.1173	Acc@1 6.374	Acc@5 23.881
 ** Acc@1 6.650, Acc@5 24.330
==> training...
Epoch: [8][0/782]	GPU 0	Time: 23.464	Loss 0.4568	Acc@1 6.250	Acc@5 28.125
Epoch: [8][200/782]	GPU 0	Time: 31.364	Loss 0.4773	Acc@1 6.646	Acc@5 24.262
Epoch: [8][400/782]	GPU 0	Time: 37.406	Loss 0.4765	Acc@1 6.503	Acc@5 23.812
Epoch: [8][600/782]	GPU 0	Time: 41.496	Loss 0.4753	Acc@1 6.882	Acc@5 24.264
 * Epoch 8, GPU 0, Acc@1 6.988, Acc@5 24.416, Time 62.27
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.558	Loss 3.9921	Acc@1 12.500	Acc@5 28.125
Test: [200/313]	GPU: 0	Time: 12.119	Loss 4.0566	Acc@1 7.603	Acc@5 26.026
 ** Acc@1 7.800, Acc@5 26.840
==> training...
Epoch: [9][0/782]	GPU 0	Time: 26.375	Loss 0.4733	Acc@1 9.375	Acc@5 25.000
Epoch: [9][200/782]	GPU 0	Time: 32.932	Loss 0.4746	Acc@1 7.439	Acc@5 25.661
Epoch: [9][400/782]	GPU 0	Time: 39.557	Loss 0.4733	Acc@1 7.524	Acc@5 25.842
Epoch: [9][600/782]	GPU 0	Time: 46.405	Loss 0.4728	Acc@1 7.654	Acc@5 25.985
 * Epoch 9, GPU 0, Acc@1 7.790, Acc@5 26.314, Time 76.28
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.708	Loss 3.8963	Acc@1 9.375	Acc@5 28.125
Test: [200/313]	GPU: 0	Time: 11.623	Loss 3.9858	Acc@1 8.007	Acc@5 28.016
 ** Acc@1 8.470, Acc@5 28.440
==> training...
Epoch: [10][0/782]	GPU 0	Time: 23.721	Loss 0.4859	Acc@1 6.250	Acc@5 25.000
Epoch: [10][200/782]	GPU 0	Time: 30.172	Loss 0.4695	Acc@1 7.952	Acc@5 27.472
Epoch: [10][400/782]	GPU 0	Time: 36.641	Loss 0.4702	Acc@1 8.218	Acc@5 27.767
Epoch: [10][600/782]	GPU 0	Time: 43.542	Loss 0.4696	Acc@1 8.447	Acc@5 28.286
 * Epoch 10, GPU 0, Acc@1 8.610, Acc@5 28.680, Time 71.24
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 14.782	Loss 3.7821	Acc@1 9.375	Acc@5 28.125
Test: [200/313]	GPU: 0	Time: 16.229	Loss 3.9114	Acc@1 9.297	Acc@5 30.348
 ** Acc@1 9.370, Acc@5 30.800
==> training...
Epoch: [11][0/782]	GPU 0	Time: 24.340	Loss 0.4510	Acc@1 9.375	Acc@5 31.250
Epoch: [11][200/782]	GPU 0	Time: 30.474	Loss 0.4694	Acc@1 9.041	Acc@5 30.169
Epoch: [11][400/782]	GPU 0	Time: 36.897	Loss 0.4675	Acc@1 9.145	Acc@5 30.471
Epoch: [11][600/782]	GPU 0	Time: 42.849	Loss 0.4674	Acc@1 9.453	Acc@5 30.886
 * Epoch 11, GPU 0, Acc@1 9.494, Acc@5 30.938, Time 75.07
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.769	Loss 3.8033	Acc@1 12.500	Acc@5 31.250
Test: [200/313]	GPU: 0	Time: 12.312	Loss 3.8569	Acc@1 10.588	Acc@5 33.038
 ** Acc@1 10.750, Acc@5 33.490
==> training...
Epoch: [12][0/782]	GPU 0	Time: 25.078	Loss 0.4429	Acc@1 12.500	Acc@5 35.938
Epoch: [12][200/782]	GPU 0	Time: 27.941	Loss 0.4643	Acc@1 10.129	Acc@5 31.973
Epoch: [12][400/782]	GPU 0	Time: 32.003	Loss 0.4636	Acc@1 10.423	Acc@5 32.544
Epoch: [12][600/782]	GPU 0	Time: 37.790	Loss 0.4632	Acc@1 10.397	Acc@5 32.709
 * Epoch 12, GPU 0, Acc@1 10.620, Acc@5 33.056, Time 70.49
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.105	Loss 3.7544	Acc@1 15.625	Acc@5 34.375
Test: [200/313]	GPU: 0	Time: 12.601	Loss 3.7859	Acc@1 11.863	Acc@5 35.930
 ** Acc@1 12.200, Acc@5 36.060
==> training...
Epoch: [13][0/782]	GPU 0	Time: 24.516	Loss 0.4710	Acc@1 4.688	Acc@5 32.812
Epoch: [13][200/782]	GPU 0	Time: 27.447	Loss 0.4602	Acc@1 11.629	Acc@5 34.779
Epoch: [13][400/782]	GPU 0	Time: 30.886	Loss 0.4603	Acc@1 11.612	Acc@5 34.928
Epoch: [13][600/782]	GPU 0	Time: 34.873	Loss 0.4609	Acc@1 11.686	Acc@5 35.020
 * Epoch 13, GPU 0, Acc@1 11.844, Acc@5 35.368, Time 61.45
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.256	Loss 3.5743	Acc@1 12.500	Acc@5 37.500
Test: [200/313]	GPU: 0	Time: 12.709	Loss 3.7280	Acc@1 13.340	Acc@5 37.749
 ** Acc@1 13.240, Acc@5 38.150
==> training...
Epoch: [14][0/782]	GPU 0	Time: 24.394	Loss 0.4888	Acc@1 14.062	Acc@5 34.375
Epoch: [14][200/782]	GPU 0	Time: 27.658	Loss 0.4582	Acc@1 12.516	Acc@5 36.917
Epoch: [14][400/782]	GPU 0	Time: 31.084	Loss 0.4575	Acc@1 12.847	Acc@5 37.130
Epoch: [14][600/782]	GPU 0	Time: 34.322	Loss 0.4569	Acc@1 12.900	Acc@5 37.341
 * Epoch 14, GPU 0, Acc@1 13.086, Acc@5 37.578, Time 50.54
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.464	Loss 3.5445	Acc@1 15.625	Acc@5 37.500
Test: [200/313]	GPU: 0	Time: 12.513	Loss 3.6534	Acc@1 14.319	Acc@5 40.283
 ** Acc@1 14.300, Acc@5 40.830
==> training...
Epoch: [15][0/782]	GPU 0	Time: 23.889	Loss 0.4570	Acc@1 14.062	Acc@5 35.938
Epoch: [15][200/782]	GPU 0	Time: 31.382	Loss 0.4531	Acc@1 14.638	Acc@5 39.824
Epoch: [15][400/782]	GPU 0	Time: 37.042	Loss 0.4531	Acc@1 14.398	Acc@5 39.764
Epoch: [15][600/782]	GPU 0	Time: 40.965	Loss 0.4531	Acc@1 14.504	Acc@5 39.923
 * Epoch 15, GPU 0, Acc@1 14.526, Acc@5 40.018, Time 59.61
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.553	Loss 3.4622	Acc@1 15.625	Acc@5 40.625
Test: [200/313]	GPU: 0	Time: 12.008	Loss 3.5835	Acc@1 16.185	Acc@5 43.237
 ** Acc@1 16.350, Acc@5 43.300
==> training...
Epoch: [16][0/782]	GPU 0	Time: 24.026	Loss 0.4821	Acc@1 15.625	Acc@5 37.500
Epoch: [16][200/782]	GPU 0	Time: 32.006	Loss 0.4505	Acc@1 15.151	Acc@5 42.141
Epoch: [16][400/782]	GPU 0	Time: 38.965	Loss 0.4500	Acc@1 15.578	Acc@5 42.191
Epoch: [16][600/782]	GPU 0	Time: 44.559	Loss 0.4492	Acc@1 15.911	Acc@5 42.016
 * Epoch 16, GPU 0, Acc@1 16.080, Acc@5 42.222, Time 70.66
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.579	Loss 3.3363	Acc@1 18.750	Acc@5 53.125
Test: [200/313]	GPU: 0	Time: 11.989	Loss 3.4946	Acc@1 17.600	Acc@5 44.667
 ** Acc@1 17.450, Acc@5 45.130
==> training...
Epoch: [17][0/782]	GPU 0	Time: 23.960	Loss 0.4235	Acc@1 26.562	Acc@5 56.250
Epoch: [17][200/782]	GPU 0	Time: 30.985	Loss 0.4448	Acc@1 17.040	Acc@5 44.333
Epoch: [17][400/782]	GPU 0	Time: 38.210	Loss 0.4440	Acc@1 17.117	Acc@5 44.034
Epoch: [17][600/782]	GPU 0	Time: 45.595	Loss 0.4435	Acc@1 17.408	Acc@5 44.296
 * Epoch 17, GPU 0, Acc@1 17.394, Acc@5 44.270, Time 77.38
GPU 0 validating
Test: [0/313]	GPU: 0	Time: 10.824	Loss 3.2571	Acc@1 28.125	Acc@5 43.750
Test: [200/313]	GPU: 0	Time: 11.794	Loss 3.4198	Acc@1 18.688	Acc@5 46.098
 ** Acc@1 19.130, Acc@5 46.820
==> training...
Epoch: [18][0/782]	GPU 0	Time: 23.882	Loss 0.4409	Acc@1 12.500	Acc@5 43.750
Epoch: [18][200/782]	GPU 0	Time: 30.758	Loss 0.4407	Acc@1 18.113	Acc@5 46.183
Epoch: [18][400/782]	GPU 0	Time: 38.546	Loss 0.4413	Acc@1 18.290	Acc@5 45.835
Epoch: [18][600/782]	GPU 0	Time: 46.041	Loss 0.4397	Acc@1 18.506	Acc@5 45.923
 * Epoch 18, GPU 0, Acc@1 18.612, Acc@5 46.262, Time 75.82
GPU 0 validating
